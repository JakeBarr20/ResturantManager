<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: tracker.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: tracker.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-analytics.js";
import { getFirestore, collection, onSnapshot, query, where, deleteField, deleteDoc, doc, orderBy, getDocs, updateDoc,getDoc } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-firestore.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyD_-a7AcOzc2g4awLO2PeneU8enHKBw7cU",
  authDomain: "restaurant-database-92c17.firebaseapp.com",
  projectId: "restaurant-database-92c17",
  storageBucket: "restaurant-database-92c17.appspot.com",
  messagingSenderId: "673538791861",
  appId: "1:673538791861:web:3eb8b2c76a041fa64be1fc",
  measurementId: "G-5PQJ0CN4YQ"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getFirestore(app);
console.log(app);
let unsubscribe;
let TiD;

const btnR = document.getElementById("redo");
const btnH = document.getElementById("help");
btnR.addEventListener("click", orderAgain);
btnH.addEventListener("click", needsHelp);

/**
 * Gets the status of an order and updates 
 * @param {String} orderID - The id of the table
 * @async
 * @method
 */
async function getStatus(orderid){  
  if (unsubscribe) unsubscribe();

  const q = query(collection(db, "Orders"),where("TableNum", "==", Number(orderid)));
  const querySnapshot = await getDocs(q);

  unsubscribe = onSnapshot(q, (querySnapshot) => {
    // Search Dependent Display Condition (if search failed, display ...)
    if (querySnapshot.empty) {
      generateWarning(orderNum);
    } else {
      // Status Dependent Order Display
      let changes = querySnapshot.docChanges();
      changes.forEach((change) => {
        const tb = document.getElementById("textbox");
        tb.innerHTML = "Order Status: " + change.doc.data().Status;  

      });
    }
  });
}

/**
 * Locates the item to be removed and removes it
 * @async
 * @method
 */
async function needsHelp() {
  let id = 0;
  const q = query(
    collection(db, "Table"),
    where("TableNum", "==", Number(localStorage.tableNum))
  );
  const querySnapshot = await getDocs(q);
  querySnapshot.forEach(function (doc) {
    id = doc.id;
    console.log(doc);
  });
  const tablesRef = doc(db, "Table", `${id}`);
  await updateDoc(tablesRef, {
    needHelp: true,
  });
}


function orderAgain(){
  window.location.href='intro';
} 

window.onload = function(){
  TiD = localStorage.tableNum
  getStatus(TiD);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#getStatus">getStatus</a></li><li><a href="global.html#needsHelp">needsHelp</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Mon Mar 28 2022 20:22:14 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
